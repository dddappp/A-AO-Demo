var structuredHeader;!function(){"use strict";var e={590:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0,s(i(223),t),s(i(759),t),s(i(985),t),s(i(128),t);var n=i(0);Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return n.Token}})},759:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ParseError=t.parseItem=t.parseList=t.parseDictionary=void 0;const r=i(985),s=i(0),n=i(128);t.parseDictionary=function(e){return new a(e).parseDictionary()},t.parseList=function(e){return new a(e).parseList()},t.parseItem=function(e){return new a(e).parseItem()};class o extends Error{constructor(e,t){super(`Parse error: ${t} at offset ${e}`)}}t.ParseError=o;class a{constructor(e){this.input=e,this.pos=0}parseDictionary(){this.skipWS();const e=new Map;for(;!this.eof();){const t=this.parseKey();let i;if("="===this.lookChar()?(this.pos++,i=this.parseItemOrInnerList()):i=[!0,this.parseParameters()],e.set(t,i),this.skipOWS(),this.eof())return e;if(this.expectChar(","),this.pos++,this.skipOWS(),this.eof())throw new o(this.pos,"Dictionary contained a trailing comma")}return e}parseList(){this.skipWS();const e=[];for(;!this.eof();){if(e.push(this.parseItemOrInnerList()),this.skipOWS(),this.eof())return e;if(this.expectChar(","),this.pos++,this.skipOWS(),this.eof())throw new o(this.pos,"A list may not end with a trailing comma")}return e}parseItem(e=!0){e&&this.skipWS();const t=[this.parseBareItem(),this.parseParameters()];return e&&this.checkTrail(),t}parseItemOrInnerList(){return"("===this.lookChar()?this.parseInnerList():this.parseItem(!1)}parseInnerList(){this.expectChar("("),this.pos++;const e=[];for(;!this.eof();){if(this.skipWS(),")"===this.lookChar())return this.pos++,[e,this.parseParameters()];e.push(this.parseItem(!1));const t=this.lookChar();if(" "!==t&&")"!==t)throw new o(this.pos,"Expected a whitespace or ) after every item in an inner list")}throw new o(this.pos,"Could not find end of inner list")}parseBareItem(){const e=this.lookChar();if(void 0===e)throw new o(this.pos,"Unexpected end of string");if(e.match(/^[-0-9]/))return this.parseIntegerOrDecimal();if('"'===e)return this.parseString();if(e.match(/^[A-Za-z*]/))return this.parseToken();if(":"===e)return this.parseByteSequence();if("?"===e)return this.parseBoolean();throw new o(this.pos,"Unexpected input")}parseParameters(){const e=new Map;for(;!this.eof()&&";"===this.lookChar();){this.pos++,this.skipWS();const t=this.parseKey();let i=!0;"="===this.lookChar()&&(this.pos++,i=this.parseBareItem()),e.set(t,i)}return e}parseIntegerOrDecimal(){let e="integer",t=1,i="";if("-"===this.lookChar()&&(t=-1,this.pos++),!c(this.lookChar()))throw new o(this.pos,"Expected a digit (0-9)");for(;!this.eof();){const t=this.getChar();if(c(t))i+=t;else{if("integer"!==e||"."!==t){this.pos--;break}if(i.length>12)throw new o(this.pos,"Exceeded maximum decimal length");i+=".",e="decimal"}if("integer"===e&&i.length>15)throw new o(this.pos,"Exceeded maximum integer length");if("decimal"===e&&i.length>16)throw new o(this.pos,"Exceeded maximum decimal length")}if("integer"===e)return parseInt(i,10)*t;if(i.endsWith("."))throw new o(this.pos,"Decimal cannot end on a period");if(i.split(".")[1].length>3)throw new o(this.pos,"Number of digits after the decimal point cannot exceed 3");return parseFloat(i)*t}parseString(){let e="";for(this.expectChar('"'),this.pos++;!this.eof();){const t=this.getChar();if("\\"===t){if(this.eof())throw new o(this.pos,"Unexpected end of input");const t=this.getChar();if("\\"!==t&&'"'!==t)throw new o(this.pos,"A backslash must be followed by another backslash or double quote");e+=t}else{if('"'===t)return e;if(!(0,n.isAscii)(t))throw new o(this.pos,"Strings must be in the ASCII range");e+=t}}throw new o(this.pos,"Unexpected end of input")}parseToken(){let e="";for(;!this.eof();){const t=this.lookChar();if(void 0===t||!/^[:/!#$%&'*+\-.^_`|~A-Za-z0-9]$/.test(t))return new s.Token(e);e+=this.getChar()}return new s.Token(e)}parseByteSequence(){this.expectChar(":"),this.pos++;const e=this.input.indexOf(":",this.pos);if(-1===e)throw new o(this.pos,'Could not find a closing ":" character to mark end of Byte Sequence');const t=this.input.substring(this.pos,e);if(this.pos+=t.length+1,!/^[A-Za-z0-9+/=]*$/.test(t))throw new o(this.pos,"ByteSequence does not contain a valid base64 string");return new r.ByteSequence(t)}parseBoolean(){this.expectChar("?"),this.pos++;const e=this.getChar();if("1"===e)return!0;if("0"===e)return!1;throw new o(this.pos,'Unexpected character. Expected a "1" or a "0"')}parseKey(){var e;if(!(null===(e=this.lookChar())||void 0===e?void 0:e.match(/^[a-z*]/)))throw new o(this.pos,"A key must begin with an asterisk or letter (a-z)");let t="";for(;!this.eof();){const e=this.lookChar();if(void 0===e||!/^[a-z0-9_\-.*]$/.test(e))return t;t+=this.getChar()}return t}lookChar(){return this.input[this.pos]}expectChar(e){if(this.lookChar()!==e)throw new o(this.pos,`Expected ${e}`)}getChar(){return this.input[this.pos++]}eof(){return this.pos>=this.input.length}skipOWS(){for(;;){const e=this.input.substr(this.pos,1);if(" "!==e&&"\t"!==e)break;this.pos++}}skipWS(){for(;" "===this.lookChar();)this.pos++}checkTrail(){if(this.skipWS(),!this.eof())throw new o(this.pos,"Unexpected characters at end of input")}}t.default=a;const h=/^[0-9]$/;function c(e){return void 0!==e&&h.test(e)}},223:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.serializeKey=t.serializeParameters=t.serializeToken=t.serializeByteSequence=t.serializeBoolean=t.serializeString=t.serializeDecimal=t.serializeInteger=t.serializeBareItem=t.serializeInnerList=t.serializeItem=t.serializeDictionary=t.serializeList=t.SerializeError=void 0;const r=i(985),s=i(0),n=i(128);class o extends Error{}function a(e){return c(e[0])+m(e[1])}function h(e){return`(${e[0].map((e=>a(e))).join(" ")})${m(e[1])}`}function c(e){if("number"==typeof e)return Number.isInteger(e)?u(e):p(e);if("string"==typeof e)return l(e);if(e instanceof s.Token)return w(e);if(e instanceof r.ByteSequence)return d(e);if("boolean"==typeof e)return f(e);throw new o("Cannot serialize values of type "+typeof e)}function u(e){if(e<-999999999999999||e>999999999999999)throw new o("Structured headers can only encode integers in the range range of -999,999,999,999,999 to 999,999,999,999,999 inclusive");return e.toString()}function p(e){const t=e.toFixed(3).replace(/0+$/,"");if(t.split(".")[0].replace("-","").length>12)throw new o("Fractional numbers are not allowed to have more than 12 significant digits before the decimal point");return t}function l(e){if(!(0,n.isAscii)(e))throw new o("Only ASCII strings may be serialized");return`"${e.replace(/("|\\)/g,(e=>"\\"+e))}"`}function f(e){return e?"?1":"?0"}function d(e){return`:${e.toBase64()}:`}function w(e){return e.toString()}function m(e){return Array.from(e).map((([e,t])=>{let i=";"+g(e);return!0!==t&&(i+="="+c(t)),i})).join("")}function g(e){if(!(0,n.isValidKeyStr)(e))throw new o("Keys in dictionaries must only contain lowercase letter, numbers, _-*. and must start with a letter or *");return e}t.SerializeError=o,t.serializeList=function(e){return e.map((e=>(0,n.isInnerList)(e)?h(e):a(e))).join(", ")},t.serializeDictionary=function(e){return Array.from(e.entries()).map((([e,t])=>{let i=g(e);return!0===t[0]?i+=m(t[1]):(i+="=",(0,n.isInnerList)(t)?i+=h(t):i+=a(t)),i})).join(", ")},t.serializeItem=a,t.serializeInnerList=h,t.serializeBareItem=c,t.serializeInteger=u,t.serializeDecimal=p,t.serializeString=l,t.serializeBoolean=f,t.serializeByteSequence=d,t.serializeToken=w,t.serializeParameters=m,t.serializeKey=g},0:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0;const r=i(128);t.Token=class{constructor(e){if(!(0,r.isValidTokenStr)(e))throw new TypeError("Invalid character in Token string. Tokens must start with *, A-Z and the rest of the string may only contain a-z, A-Z, 0-9, :/!#$%&'*+-.^_`|~");this.value=e}toString(){return this.value}}},985:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ByteSequence=void 0,t.ByteSequence=class{constructor(e){this.base64Value=e}toBase64(){return this.base64Value}}},128:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isByteSequence=t.isInnerList=t.isValidKeyStr=t.isValidTokenStr=t.isAscii=void 0;const i=/^[\x20-\x7E]*$/,r=/^[a-zA-Z*][:/!#$%&'*+\-.^_`|~A-Za-z0-9]*$/,s=/^[a-z*][*\-_.a-z0-9]*$/;t.isAscii=function(e){return i.test(e)},t.isValidTokenStr=function(e){return r.test(e)},t.isValidKeyStr=function(e){return s.test(e)},t.isInnerList=function(e){return Array.isArray(e[0])},t.isByteSequence=function(e){return"object"==typeof e&&"base64Value"in e}}},t={},i=function i(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,i),n.exports}(590);structuredHeader=i}();
//# sourceMappingURL=structured-header.min.js.map