# é›†æˆæ£€æŸ¥æ¸…å•

æŒ‰ç…§æœ¬æ¸…å•é€é¡¹æ£€æŸ¥ï¼Œç¡®ä¿è®¤è¯æ¨¡å—æ­£ç¡®é›†æˆåˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚

## âœ… ä»£ç é›†æˆ

- [ ] æ‹·è´äº† `config/`, `controller/`, `dto/`, `entity/`, `repository/`, `service/` ç›®å½•
- [ ] ä½¿ç”¨ IDE é‡æ„æˆ– sed å‘½ä»¤ä¿®æ”¹äº†æ‰€æœ‰åŒ…åå¼•ç”¨
- [ ] éªŒè¯äº†ä¸»åº”ç”¨ç±»ä¸­çš„ `@EnableJpaRepositories` å’Œ `@ComponentScan` æ³¨è§£
- [ ] æ£€æŸ¥äº†æ˜¯å¦æœ‰ç¡¬ç¼–ç çš„åŒ…åè·¯å¾„

## ğŸ“¦ Maven ä¾èµ–

- [ ] æ·»åŠ äº† `spring-boot-starter-security`
- [ ] æ·»åŠ äº† `spring-boot-starter-data-jpa`
- [ ] æ·»åŠ äº† `org.postgresql:postgresql`
- [ ] æ·»åŠ äº† JWT ç›¸å…³ä¾èµ–ï¼ˆjjwt-api, jjwt-impl, jjwt-jacksonï¼‰
- [ ] æ·»åŠ äº† `spring-security-oauth2-authorization-server` ï¼ˆå¯é€‰ï¼‰
- [ ] æ·»åŠ äº† `spring-boot-starter-oauth2-client` ï¼ˆå¯é€‰ï¼‰
- [ ] æ·»åŠ äº† `org.springframework.session:spring-session-jdbc` ï¼ˆå¯é€‰ä½†æ¨èï¼Œç”¨äº session æŒä¹…åŒ–ï¼‰

## ğŸ—„ï¸ æ•°æ®åº“

- [ ] PostgreSQL å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] åˆ›å»ºäº†æ•°æ®åº“ï¼š`your_project_db`
- [ ] æ‰§è¡Œäº† `schema-postgresql.sql` è„šæœ¬åˆ›å»ºè¡¨
- [ ] éªŒè¯äº†ä»¥ä¸‹è®¤è¯ç›¸å…³çš„è¡¨å·²åˆ›å»ºï¼š
  - [ ] `users`
  - [ ] `user_login_methods`
  - [ ] `user_authorities`
  - [ ] `token_blacklist`

- [ ] ï¼ˆå¯é€‰ï¼‰éªŒè¯äº† Spring Session JDBC è¡¨å·²åˆ›å»ºï¼ˆå¦‚æœå¯ç”¨äº† session æŒä¹…åŒ–ï¼‰ï¼š
  - [ ] `SPRING_SESSION` - å­˜å‚¨ session ä¿¡æ¯
  - [ ] `SPRING_SESSION_ATTRIBUTES` - å­˜å‚¨ session å±æ€§å€¼

## âš™ï¸ é…ç½®æ–‡ä»¶

- [ ] åˆ›å»ºäº† `application.yml` å¹¶é…ç½®äº†ä»¥ä¸‹å†…å®¹ï¼š
  - [ ] `spring.datasource.url` - PostgreSQL è¿æ¥å­—ç¬¦ä¸²
  - [ ] `spring.datasource.username` - æ•°æ®åº“ç”¨æˆ·å
  - [ ] `spring.datasource.password` - æ•°æ®åº“å¯†ç 
  - [ ] `spring.jpa.hibernate.ddl-auto` - è®¾ç½®ä¸º `validate` æˆ– `update`
  - [ ] `spring.jpa.database-platform` - è®¾ç½®ä¸º `org.hibernate.dialect.PostgreSQLDialect`
  - [ ] ï¼ˆå¯é€‰ï¼‰`spring.session.store-type: jdbc` - å¯ç”¨ JDBC session æŒä¹…åŒ–
  - [ ] ï¼ˆå¯é€‰ï¼‰`spring.session.jdbc.initialize-schema: always` - è‡ªåŠ¨åˆ›å»º session è¡¨

- [ ] å¦‚æœéœ€è¦ OAuth2ï¼Œé…ç½®äº†ï¼š
  - [ ] `spring.security.oauth2.client.registration.google` ï¼ˆGoogleï¼‰
  - [ ] `spring.security.oauth2.client.registration.github` ï¼ˆGitHubï¼Œå¯é€‰ï¼‰
  - [ ] `spring.security.oauth2.client.registration.x` ï¼ˆTwitterï¼Œå¯é€‰ï¼‰

## ğŸš€ åº”ç”¨å¯åŠ¨éªŒè¯

- [ ] åº”ç”¨æˆåŠŸå¯åŠ¨ï¼Œæ²¡æœ‰ç¼–è¯‘é”™è¯¯
- [ ] æ—¥å¿—ä¸­æ²¡æœ‰å…³é”®çš„ Bean åˆå§‹åŒ–é”™è¯¯
- [ ] æ•°æ®åº“è¿æ¥æˆåŠŸ
- [ ] æ‰€æœ‰ Repository æˆåŠŸåŠ è½½
- [ ] ï¼ˆå¯é€‰ï¼‰Spring Session JDBC åˆå§‹åŒ–æˆåŠŸï¼ŒSPRING_SESSION è¡¨å·²åˆ›å»º

## ğŸ§ª åŠŸèƒ½æµ‹è¯•

### æœ¬åœ°ç™»å½•æµç¨‹
- [ ] æˆåŠŸæ³¨å†Œæ–°ç”¨æˆ·ï¼ˆPOST /api/auth/registerï¼‰
- [ ] æˆåŠŸç™»å½•å·²æ³¨å†Œç”¨æˆ·ï¼ˆPOST /api/auth/loginï¼‰
- [ ] è·å–äº†æœ‰æ•ˆçš„ Access Token å’Œ Refresh Token
- [ ] ä½¿ç”¨ Token æˆåŠŸè®¿é—®å—ä¿æŠ¤èµ„æºï¼ˆGET /api/auth/current-userï¼‰
- [ ] Token è¿‡æœŸåæˆåŠŸåˆ·æ–°ï¼ˆPOST /api/auth/refreshï¼‰
- [ ] æˆåŠŸç™»å‡ºï¼ˆPOST /api/auth/logoutï¼‰

### ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- [ ] å¯ä»¥è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆGET /api/auth/current-userï¼‰
- [ ] å¯ä»¥æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆPUT /api/auth/userï¼‰
- [ ] å¯ä»¥æŸ¥çœ‹ç”¨æˆ·çš„æ‰€æœ‰ç™»å½•æ–¹å¼ï¼ˆGET /api/user/login-methodsï¼‰

### æƒé™ç®¡ç†ï¼ˆå¦‚æœå·²é…ç½®ï¼‰
- [ ] ç”¨æˆ·å…·æœ‰æ­£ç¡®çš„æƒé™æ ‡è®°ï¼ˆROLE_USER, ROLE_ADMIN ç­‰ï¼‰
- [ ] å—ä¿æŠ¤çš„ç«¯ç‚¹æ­£ç¡®æ£€æŸ¥æƒé™
- [ ] `@PreAuthorize` æ³¨è§£æ­£å¸¸å·¥ä½œ

## ğŸ”Œ OAuth2 é›†æˆï¼ˆå¯é€‰ï¼‰

### Google OAuth2
- [ ] è·å–äº† Google Client ID å’Œ Client Secret
- [ ] åœ¨ Google Cloud Console ä¸­é…ç½®äº†é‡å®šå‘ URI
- [ ] ç¯å¢ƒå˜é‡ `GOOGLE_CLIENT_ID` å’Œ `GOOGLE_CLIENT_SECRET` å·²è®¾ç½®
- [ ] æˆåŠŸè·³è½¬åˆ° Google ç™»å½•é¡µé¢
- [ ] ç”¨æˆ·æˆæƒåæˆåŠŸå›è°ƒ
- [ ] ç”¨æˆ·ä¿¡æ¯æ­£ç¡®ä¿å­˜åˆ°æ•°æ®åº“

### GitHub OAuth2ï¼ˆå¯é€‰ï¼‰
- [ ] è·å–äº† GitHub Client ID å’Œ Client Secret
- [ ] åœ¨ GitHub ä¸­é…ç½®äº†æˆæƒå›è°ƒ URL
- [ ] ç¯å¢ƒå˜é‡ `GITHUB_CLIENT_ID` å’Œ `GITHUB_CLIENT_SECRET` å·²è®¾ç½®
- [ ] æˆåŠŸè·³è½¬åˆ° GitHub ç™»å½•é¡µé¢
- [ ] ç”¨æˆ·æˆæƒåæˆåŠŸå›è°ƒ

### Twitter/X OAuth2ï¼ˆå¯é€‰ï¼‰
- [ ] è·å–äº† Twitter Client ID å’Œ Client Secret
- [ ] åœ¨ Twitter Developer Portal ä¸­é…ç½®äº†é‡å®šå‘ URI
- [ ] ç¯å¢ƒå˜é‡ `TWITTER_CLIENT_ID` å’Œ `TWITTER_CLIENT_SECRET` å·²è®¾ç½®
- [ ] æˆåŠŸè·³è½¬åˆ° Twitter ç™»å½•é¡µé¢

## ğŸ‘¥ ç”¨æˆ·ç»‘å®šï¼ˆå¦‚æœå¯ç”¨ OAuth2ï¼‰

- [ ] æœ¬åœ°ç”¨æˆ·å¯ä»¥ç»‘å®š Google è´¦æˆ·
- [ ] æœ¬åœ°ç”¨æˆ·å¯ä»¥ç»‘å®š GitHub è´¦æˆ·ï¼ˆå¦‚æœé…ç½®ï¼‰
- [ ] ç”¨æˆ·å¯ä»¥è§£ç»‘å·²ç»‘å®šçš„ SSO è´¦æˆ·
- [ ] åŒä¸€ SSO è´¦æˆ·ä¸èƒ½ç»‘å®šå¤šä¸ªæœ¬åœ°ç”¨æˆ·
- [ ] åœ¨ `user_login_methods` è¡¨ä¸­æ­£ç¡®è®°å½•äº†æ‰€æœ‰ç™»å½•æ–¹å¼

## ğŸ”’ å®‰å…¨ç›¸å…³

- [ ] å¯†ç ä½¿ç”¨ BCrypt åŠ å¯†ï¼ˆä¸æ˜¯æ˜æ–‡ï¼‰
- [ ] JWT Token ä½¿ç”¨ HMAC-SHA256 ç­¾å
- [ ] Token åœ¨ HttpOnly Cookie ä¸­å­˜å‚¨ï¼ˆé˜²æ­¢ XSSï¼‰
- [ ] CSRF ä¿æŠ¤å·²å¯ç”¨
- [ ] æ•æ„Ÿä¿¡æ¯ï¼ˆClient ID, Secret ç­‰ï¼‰å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­
- [ ] ç”Ÿäº§ç¯å¢ƒå·²é…ç½® HTTPS

## ğŸ“ æ—¥å¿—å’Œç›‘æ§

- [ ] å¯ä»¥çœ‹åˆ°è®¤è¯ç›¸å…³çš„ DEBUG æ—¥å¿—
- [ ] ç™»å½•å¤±è´¥æ—¶æœ‰æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- [ ] Token éªŒè¯å¤±è´¥æ—¶æœ‰ç›¸åº”çš„æ—¥å¿—
- [ ] å¯ä»¥è¿½è¸ªç”¨æˆ·çš„è®¤è¯å†å²

## ğŸŒ å‰ç«¯é›†æˆï¼ˆå¦‚æœæœ‰å‰ç«¯é¡¹ç›®ï¼‰

- [ ] å‰ç«¯è°ƒç”¨ `/api/auth/register` åˆ›å»ºè´¦æˆ·
- [ ] å‰ç«¯è°ƒç”¨ `/api/auth/login` è¿›è¡Œç™»å½•
- [ ] å‰ç«¯æ­£ç¡®å­˜å‚¨å’Œä½¿ç”¨ Access Token
- [ ] å‰ç«¯åœ¨è¯·æ±‚ header ä¸­æ·»åŠ  `Authorization: Bearer <token>`
- [ ] å‰ç«¯å¤„ç† 401 é”™è¯¯å¹¶åˆ·æ–° Token
- [ ] å‰ç«¯æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ï¼ˆä» `/api/auth/current-user` è·å–ï¼‰
- [ ] å‰ç«¯ç™»å‡ºæ—¶æ¸…é™¤æœ¬åœ° Token

## ğŸš€ ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥

- [ ] é…ç½®äº† `application-prod.yml`
- [ ] ç”Ÿäº§æ•°æ®åº“å·²åˆ›å»ºå¹¶åˆå§‹åŒ–
- [ ] OAuth2 credentials å·²é…ç½®ä¸ºç”Ÿäº§ç¯å¢ƒçš„å€¼
- [ ] Token è¿‡æœŸæ—¶é—´è®¾ç½®åˆç†ï¼ˆAccess: 1 å°æ—¶ï¼ŒRefresh: 7 å¤©ï¼‰
- [ ] æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º INFOï¼ˆä¸æ˜¯ DEBUGï¼‰
- [ ] å¯ç”¨äº† HTTPS å’Œå®‰å…¨ Cookie
- [ ] æ•°æ®åº“å¤‡ä»½ç­–ç•¥å·²å®æ–½

## ğŸ“Š æ€§èƒ½ç›¸å…³

- [ ] æµ‹è¯•äº†å¤§é‡ç”¨æˆ·ç™»å½•åœºæ™¯ï¼ˆå¹¶å‘ï¼‰
- [ ] æŸ¥çœ‹äº†æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½ï¼ˆå¯ç”¨ EXPLAIN åˆ†æï¼‰
- [ ] é…ç½®äº†æ•°æ®åº“è¿æ¥æ± å¤§å°ï¼ˆHikariCPï¼‰
- [ ] è®¤è¯ç«¯ç‚¹çš„å“åº”æ—¶é—´åœ¨å¯æ¥å—èŒƒå›´å†…ï¼ˆ< 500msï¼‰

## ğŸ“‹ æ–‡æ¡£å’Œç»´æŠ¤

- [ ] æ›´æ–°äº†é¡¹ç›®çš„ READMEï¼Œè¯´æ˜è®¤è¯åŠŸèƒ½
- [ ] ä¸ºæ–°å¢çš„è‡ªå®šä¹‰å­—æ®µç¼–å†™äº†æ³¨é‡Š
- [ ] è®°å½•äº†ä»»ä½•ä¿®æ”¹å’Œæ‰©å±•
- [ ] åˆ›å»ºäº†è¿ç»´æ–‡æ¡£ï¼ˆå¦‚ä½•é‡ç½®å¯†ç ã€ç®¡ç†ç”¨æˆ·ç­‰ï¼‰

## âŒ å¸¸è§é—®é¢˜è‡ªæ£€

### ç¼–è¯‘é—®é¢˜
- [ ] æ‰€æœ‰åŒ…åéƒ½æ­£ç¡®å¼•ç”¨ï¼ˆæ²¡æœ‰ `com.example.oauth2demo`ï¼‰
- [ ] æ²¡æœ‰å¾ªç¯ä¾èµ–
- [ ] æ‰€æœ‰å¯¼å…¥è¯­å¥æ­£ç¡®

### è¿è¡Œæ—¶é—®é¢˜
- [ ] åº”ç”¨å¯åŠ¨æ—¶æ²¡æœ‰ ClassNotFoundException
- [ ] æ²¡æœ‰ NoSuchBeanDefinitionException
- [ ] æ•°æ®åº“è¿æ¥æˆåŠŸï¼Œæ²¡æœ‰ SQLException

### åŠŸèƒ½é—®é¢˜
- [ ] ç™»å½•ä¸è¿”å› 401ï¼ˆå¯†ç å“ˆå¸Œæ­£ç¡®ï¼‰
- [ ] Token å¯ä»¥æ­£ç¡®éªŒè¯
- [ ] ç”¨æˆ·ä¿¡æ¯æ­£ç¡®ä¿å­˜å’Œè¯»å–

### é›†æˆé—®é¢˜
- [ ] æ²¡æœ‰ä¸ç°æœ‰ä»£ç å†²çª
- [ ] æƒé™ç®¡ç†ä¸ç°æœ‰ä¸šåŠ¡é€»è¾‘å…¼å®¹
- [ ] æ•°æ®åº“è¡¨åæ²¡æœ‰å†²çª

## âœ¨ é¢å¤–ä¼˜åŒ–å»ºè®®

- [ ] æ·»åŠ äº†é€Ÿç‡é™åˆ¶ï¼ˆRate Limitingï¼‰é˜²æ­¢æš´åŠ›æ”»å‡»
- [ ] é…ç½®äº† Token é»‘åå•ç®¡ç†
- [ ] å®ç°äº†å®¡è®¡æ—¥å¿—ï¼ˆè°åœ¨ä½•æ—¶è¿›è¡Œäº†è®¤è¯ï¼‰
- [ ] æ·»åŠ äº†ä¸¤å› ç´ è®¤è¯ï¼ˆ2FAï¼Œå¯é€‰ï¼‰
- [ ] é…ç½®äº†å¯†ç é‡ç½®æµç¨‹
- [ ] å®ç°äº†è´¦æˆ·é”å®šæœºåˆ¶ï¼ˆå¤šæ¬¡å¤±è´¥åï¼‰

## ğŸ”„ Session æŒä¹…åŒ–ä¸å¤šæœåŠ¡å™¨æ”¯æŒ

- [ ] å·²å¯ç”¨ Spring Session JDBCï¼ˆå¯é€‰ï¼‰
- [ ] éªŒè¯äº† SPRING_SESSION è¡¨è‡ªåŠ¨åˆ›å»º
- [ ] éªŒè¯äº† session åœ¨æ•°æ®åº“ä¸­æŒä¹…åŒ–
- [ ] æµ‹è¯•äº†åº”ç”¨é‡å¯å session ä»ç„¶æœ‰æ•ˆ
- [ ] ï¼ˆå¯é€‰ï¼‰æµ‹è¯•äº†å¤šæœåŠ¡å™¨å®ä¾‹å…±äº« session
- [ ] ï¼ˆå¦‚æœä½¿ç”¨å¤šæœåŠ¡å™¨ï¼‰é…ç½®äº†æ‰€æœ‰å®ä¾‹æŒ‡å‘åŒä¸€æ•°æ®åº“
- [ ] ç›‘æ§äº† SPRING_SESSION è¡¨çš„å¤§å°å’Œæ€§èƒ½

---

## ğŸ¯ å®Œæˆæ ‡å¿—

å½“æ‰€æœ‰é¡¹éƒ½å·²æ£€æŸ¥ä¸”æ‰“å‹¾æ—¶ï¼Œæ­å–œä½ ï¼è®¤è¯æ¨¡å—å·²æˆåŠŸé›†æˆåˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚

æœ€åä¸€æ­¥ï¼š
```bash
# è¿è¡Œåº”ç”¨
mvn spring-boot:run

# æˆ–ä½¿ç”¨ IDE çš„ Run æŒ‰é’®
# æˆ–æ‰“åŒ…åè¿è¡Œï¼š
mvn clean package
java -jar target/your-project.jar
```

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·å‚è€ƒ `INTEGRATION-GUIDE.md` ä¸­çš„ "å¸¸è§é›†æˆé—®é¢˜æ’æŸ¥" éƒ¨åˆ†ã€‚
