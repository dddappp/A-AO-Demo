# SAGAä¿®å¤è¿›åº¦è·Ÿè¸ªæ–‡æ¡£


## ğŸ“‹ ä»»åŠ¡ç›®æ ‡
ä¿®å¤AO Sagaæ¡†æ¶ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨AO Tagè¿‡æ»¤æœºåˆ¶ä¸‹æ­£å¸¸å·¥ä½œã€‚

## ğŸ¯ é—®é¢˜èƒŒæ™¯

@README_CN.md æè¿°çš„ä¸¤è¿›ç¨‹ ï¼ˆalice å’Œ bobï¼‰Saga æµ‹è¯•åœ¨ ao å¯¹ Tags è¿›è¡Œè¿‡æ»¤å‰ï¼Œæ˜¯å®é™…æµ‹è¯•é€šè¿‡çš„ï¼
æˆ‘ä»¬ç›®å‰é¢ä¸´çš„é—®é¢˜æ˜¯ï¼šåœ¨ ao ç‰ˆæœ¬æ›´æ–°åï¼Œå¢åŠ äº†å¯¹ Tags çš„è¿‡æ»¤ï¼Œå¯¼è‡´åŸæ¥å·²ç»é€šè¿‡æµ‹è¯•çš„ Saga æ‰§è¡Œè¿‡ç¨‹å¤±è´¥ã€‚
ä¸ºæ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ›¿ä»£æ–¹æ¡ˆçš„é—®é¢˜ã€‚ï¼ˆåˆ†æè®¨è®ºå‚è€ƒï¼š @SAGA-TECHNICAL-ANALYSIS.md ï¼‰

> NOTEï¼šä»¥ä¸‹æµ‹è¯•æ˜¯åœ¨æäº¤ `615b9a11a3b1f18deea99e255f9a4ac1da1f0073` å‰ï¼Œæ‰€åšçš„æµ‹è¯•ã€‚è€Œæ­¤åçš„ä»£ç ä¿®æ”¹ï¼Œå³æ˜¯å°è¯•ä½¿ç”¨ Data åµŒå…¥ Saga ä¿¡æ¯æ¥è§£å†³é—®é¢˜ã€‚

ä»å¤±è´¥çš„æµ‹è¯•è®°å½•
@process_alice_1008.txt @process_alice_1008.txt 
æ¥çœ‹ï¼šbob è¿›ç¨‹å·²ç»å¼€å§‹æ‰§è¡Œ Sagaï¼Œç„¶åå‘ alice è¿›ç¨‹å‘å‡ºäº† â€œæŸ¥è¯¢åº“å­˜è¯·æ±‚â€ï¼Œå¹¶ä¸”æ”¶åˆ°äº†å›å¤ï¼š

```
Data = "{"result":{"version":0,"quantity":100,"inventory_item_id":{"location":"y","product_id":1},"entries":[{"...
```

æµ‹è¯•å‘ˆç°å‡ºæ¥çš„é—®é¢˜æ˜¯ï¼š
å› ä¸ºå°è¯•ä½¿ç”¨æ¶ˆæ¯çš„ Tags æ¥ä¼ é€’çš„ Saga ä¿¡æ¯å‘ç”Ÿä¸¢å¤±ï¼ˆè¢« ao æ–°ç‰ˆæœ¬è¿‡æ»¤æ‰äº†ï¼‰ï¼Œå¯¼è‡´ Saga æ— æ³•æ¨è¿›åˆ°ä¸‹ä¸€æ­¥ã€‚
æ¯”å¦‚ï¼Œå¦‚æœå›å¤çš„æ¶ˆæ¯çš„ Action ä¸¢å¤±ï¼Œå°±ä¼šå¯¼è‡´æ— æ³•è§¦å‘ï¼ˆæ¥æ”¶æ¶ˆæ¯çš„è¿›ç¨‹ä¸­çš„ï¼‰ handler çš„å¤„ç†é€»è¾‘ï¼Œè€Œæœªè¢«å¤„ç†çš„æ¶ˆæ¯å°±ä¼šå‡ºç°åœ¨ Inbox ä¸­ã€‚

æˆ‘ä»¬åœ¨ @SAGA-TECHNICAL-ANALYSIS.md ä¸­åˆ†æäº†è¿™ä¸ªé—®é¢˜ã€‚
æ‰€ä»¥æ‰å¯¼è‡´äº†æœ¬æ¬¡ä»»åŠ¡çš„ä¸€ç³»åˆ—çš„ä»£ç ä¿®æ”¹â€”â€”å°è¯•ä½¿ç”¨åœ¨æ¶ˆæ¯çš„ Data ä¸­åµŒå…¥ Saga æ¶ˆæ¯ä»¥ä»£æ›¿åœ¨ Tags ä¸­åŒ…å« Saga ä¿¡æ¯çš„â€œæ—§åšæ³•â€ã€‚

> NOTEï¼šå¦‚æœè¦æƒ³è®©æ¶ˆæ¯å‡ºç°åœ¨ä¸€ä¸ªè¿›ç¨‹ Inbox é‡Œï¼Œå¯ä»¥åœ¨è¯¥è¿›ç¨‹ï¼ˆæˆ‘ä»¬åé¢ç§°ä¹‹ä¸ºâ€œåŸè¿›ç¨‹â€ï¼‰å†…ç”¨ eval çš„æ–¹å¼æ¥å‘é€æ¶ˆæ¯ã€‚
> è¿™æ ·æ”¶åˆ°æ¶ˆæ¯çš„è¿›ç¨‹å°±ä¼šä»æ¶ˆæ¯çš„ From å­—æ®µä¸­çœ‹åˆ°å‘é€æ¶ˆæ¯çš„è¿›ç¨‹ IDï¼Œç„¶åå°†æ‰§è¡Œç»“æœå›å¤ç»™è¿™ä¸ª ID æŒ‡å‘çš„è¿›ç¨‹ã€‚
> å¦‚æœæ”¶åˆ°æ¶ˆæ¯çš„è¿›ç¨‹ï¼ˆåŸè¿›ç¨‹ï¼‰æ²¡æœ‰ handler å¯ä»¥å¤„ç†æ¶ˆæ¯ï¼Œæ¶ˆæ¯å°±ä¼šå‡ºç°åœ¨åŸè¿›ç¨‹çš„ Inbox ä¸­ã€‚
> å¯ä»¥æŸ¥çœ‹ç¤ºä¾‹ @ao-cli-non-repl/tests/run-blog-tests.sh

ç»¼ä¸Šæ‰€è¿°ï¼š
- **åŸå§‹çŠ¶æ€**: README_CN.mdæè¿°çš„alice-bobä¸¤è¿›ç¨‹SAGAæµ‹è¯•æ›¾ç»é€šè¿‡
- **å½“å‰é—®é¢˜**: AOç‰ˆæœ¬æ›´æ–°åï¼ŒTagè¿‡æ»¤æœºåˆ¶å¯¼è‡´SAGAæ— æ³•æ¨è¿›
- **æ ¸å¿ƒåŸå› **: è‡ªå®šä¹‰Tagï¼ˆå¦‚X-SagaIdï¼‰åœ¨è·¨è¿›ç¨‹ä¼ é€’æ—¶è¢«AOç³»ç»Ÿè¿‡æ»¤
- **è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨DataåµŒå…¥æ›¿ä»£Tagä¼ é€’Sagaä¿¡æ¯

## ğŸ” å…³é”®å‘ç°è®°å½•

### å‘ç° #1: Action Tagå¯ä»¥æ­£å¸¸ä¼ é€’ âœ…
**æ—¶é—´**: 2025-01-10
**æµ‹è¯•**: test_process_a.lua + test_process_b.lua
**ç»“è®º**: 
- Actionå¯ä»¥ä½œä¸ºTagæ­£å¸¸ä¼ é€’ï¼ˆ`Tags = { Action = "..." }`ï¼‰
- Actionä¹Ÿå¯ä»¥ä½œä¸ºç›´æ¥å±æ€§ä¼ é€’ï¼ˆ`message.Action = "..."`ï¼‰
- AOä¼šè‡ªåŠ¨åœ¨ä¸¤ç§å½¢å¼é—´è½¬æ¢
- å½“åŒæ—¶è®¾ç½®æ—¶ï¼Œå€¼ä¼šäº¤å‰ï¼ˆå‘é€Action=A,Tags.Action=Bï¼Œæ¥æ”¶Action=B,Tags.Action=Aï¼‰

**æµ‹è¯•è¯æ®**:
```json
{
  "test": "Test1_ActionInTags",
  "action_in_tags": "TestActionInTags",
  "action_direct": "TestActionInTags"
}
```

**é‡è¦æ€§**: â­â­â­â­â­
**å½±å“**: è¿™æ„å‘³ç€ä¹‹å‰è®¤ä¸º"Actionè¢«è¿‡æ»¤"çš„ç»“è®ºæ˜¯é”™è¯¯çš„ï¼HandleråŒ¹é…åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œï¼

### å‘ç° #2: SAGAå·²ç»æ¨è¿›åˆ°æ­¥éª¤2 âœ…
**æ—¶é—´**: 2025-01-10
**æµ‹è¯•**: æ‰‹åŠ¨è°ƒè¯•alice-bobæµ‹è¯•
**ç»“è®º**:
- SAGA Instanceå½“å‰åœ¨æ­¥éª¤2ï¼ˆ`current_step: 2`ï¼‰
- æ­¥éª¤1çš„callbackï¼ˆGetInventoryItemï¼‰å·²ç»æˆåŠŸè§¦å‘
- é—®é¢˜å‡ºåœ¨æ­¥éª¤2çš„callbackï¼ˆCreateSingleLineInOutï¼‰æœªè¢«è§¦å‘

**æµ‹è¯•è¯æ®**:
```bash
ao-cli eval "$BOB" --data "saga = require('saga'); local inst = saga.get_saga_instance_copy(1); return inst and inst.current_step or 0"
# è¾“å‡º: "2"
```

**é‡è¦æ€§**: â­â­â­â­â­
**å½±å“**: SAGAæ ¸å¿ƒé€»è¾‘æ˜¯å·¥ä½œçš„ï¼é—®é¢˜å¯èƒ½ä¸åœ¨Actionä¼ é€’ï¼Œè€Œåœ¨å…¶ä»–åœ°æ–¹ï¼

### å‘ç° #3: Callback HandleræŠ¥é”™ INVALID_MESSAGE âœ…
**æ—¶é—´**: 2025-01-10
**æµ‹è¯•**: æ·»åŠ é”™è¯¯è¿½è¸ªåˆ°callback handler
**ç»“è®º**:
- æ‰‹åŠ¨å‘é€GetInventoryItem callbackæ—¶æŠ¥é”™ `INVALID_MESSAGE`
- é”™è¯¯å‘ç”Ÿåœ¨ `inventory_service.lua:100` çš„æ£€æŸ¥ï¼š
  ```lua
  if (saga_instance.current_step ~= 1 or saga_instance.compensating) then
      error(ERRORS.INVALID_MESSAGE)
  end
  ```
- å› ä¸ºSAGAå·²ç»åœ¨æ­¥éª¤2ï¼Œæ‰€ä»¥æ£€æŸ¥å¤±è´¥

**æµ‹è¯•è¯æ®**:
```json
{
  "error": "[string \"aos\"]:1843: INVALID_MESSAGE",
  "time": 1760086448414
}
```

**é‡è¦æ€§**: â­â­â­â­
**å½±å“**: è¿™è¯æ˜äº†SAGAåœ¨ç¬¬ä¸€æ¬¡çœŸå®çš„callbackæ—¶å·²ç»æ¨è¿›åˆ°æ­¥éª¤2ï¼è¯´æ˜æ­¥éª¤1æˆåŠŸäº†ï¼

### å‘ç° #4: Aliceæœ‰CreateSingleLineInOut handler âœ…
**æ—¶é—´**: 2025-01-10
**æµ‹è¯•**: æ£€æŸ¥aliceè¿›ç¨‹çš„handlers
**ç»“è®º**: aliceç¡®å®æœ‰`create_single_line_in_out` handler

**é‡è¦æ€§**: â­â­â­
**å½±å“**: Handlerå­˜åœ¨ï¼Œé—®é¢˜å¯èƒ½åœ¨æ¶ˆæ¯ä¼ é€’æˆ–handlerè§¦å‘æ¡ä»¶

## ğŸš§ å½“å‰é—®é¢˜åˆ†æ

### é—®é¢˜ç„¦ç‚¹: ä¸ºä»€ä¹ˆæ­¥éª¤2å¡ä½äº†ï¼Ÿ

**å·²çŸ¥ä¿¡æ¯**:
1. âœ… Actionå¯ä»¥æ­£å¸¸ä¼ é€’
2. âœ… æ­¥éª¤1æˆåŠŸå®Œæˆï¼ˆSAGAæ¨è¿›åˆ°æ­¥éª¤2ï¼‰
3. âœ… aliceæœ‰CreateSingleLineInOut handler
4. â“ æ­¥éª¤2çš„callbackæœªè¢«è§¦å‘

**å¯èƒ½åŸå› **:
1. **æ¶ˆæ¯æœªå‘é€**: bobæœªå‘aliceå‘é€CreateSingleLineInOutè¯·æ±‚
2. **æ¶ˆæ¯æœªåˆ°è¾¾**: æ¶ˆæ¯å‘é€äº†ä½†aliceæœªæ”¶åˆ°
3. **HandleræœªåŒ¹é…**: æ¶ˆæ¯åˆ°è¾¾ä½†handleråŒ¹é…å¤±è´¥
4. **Handleræ‰§è¡Œå¤±è´¥**: handleråŒ¹é…ä½†æ‰§è¡Œæ—¶å‡ºé”™

### å‘ç° #5: GetInventoryItem Callbackä»æœªè¢«è°ƒç”¨ï¼ğŸ”¥
**æ—¶é—´**: 2025-01-10
**æµ‹è¯•**: æ·»åŠ DEBUG_LOGè¿½è¸ªcallbackè°ƒç”¨
**ç»“è®º**:
- æ–°åˆ›å»ºçš„SAGAå®ä¾‹2ï¼Œcurrent_step=1
- GetInventoryItem callbackæœªè¢«è°ƒç”¨ï¼ˆDEBUG_LOGä¸ºç©ºï¼‰
- ç”¨æˆ·ç¡®è®¤ï¼šåœ¨ä¿®æ”¹ä»£ç å‰ï¼Œè¿™äº›æ­¥éª¤éƒ½æ˜¯å·¥ä½œçš„ï¼

**é‡è¦æ€§**: â­â­â­â­â­
**å½±å“**: ä»£ç é€»è¾‘æ£€æŸ¥ï¼š
1. âœ… bobçš„SAGAå¯åŠ¨ä»£ç æ­£ç¡®åœ°åµŒå…¥Sagaä¿¡æ¯åˆ°request Dataä¸­
2. âœ… `messaging.commit_send_or_error` -> `send` æ­£ç¡®å‘é€Dataå’ŒTags
3. âœ… aliceçš„handleræ­£ç¡®æå–Sagaä¿¡æ¯å¹¶å¤„ç†
4. âœ… `messaging.respond`æ­£ç¡®åµŒå…¥Sagaä¿¡æ¯åˆ°response Dataå¹¶è®¾ç½®Action tag
5. â“ bobçš„callback handlerå®šä¹‰æ˜¯å¦æ­£ç¡®ï¼Ÿ

### å‘ç° #6: å…³é”®ç–‘ç‚¹ - callback handlerçš„åŒ¹é…é€»è¾‘ ğŸ”¥
**æ—¶é—´**: 2025-01-10
**æ€€ç–‘**: æˆ‘ä»¬ä¿®æ”¹äº†callback handlersä½¿ç”¨`messaging.hasMatchingDataAction`ï¼Œä½†æµ‹è¯•è¯æ˜Actionå¯ä»¥æ­£å¸¸ä¼ é€’ï¼
**éœ€è¦éªŒè¯**: bobçš„callback handleræ˜¯å¦é”™è¯¯åœ°ä½¿ç”¨äº†DataåŒ¹é…è€Œä¸æ˜¯TagåŒ¹é…ï¼Ÿ

### å‘ç° #7: çœŸæ­£çš„é—®é¢˜ - X-ResponseActionè¢«è¿‡æ»¤ï¼ğŸ’¡ğŸ’¡ğŸ’¡
**æ—¶é—´**: 2025-01-10
**ç”¨æˆ·æ¾„æ¸…**: 
- âœ… Action tag **ä¸ä¼š**è¢«è¿‡æ»¤
- âŒ **è‡ªå®šä¹‰çš„X-ResponseAction tagè¢«è¿‡æ»¤**
- é—®é¢˜ï¼šåŸå§‹SAGAå®ç°ä¾èµ–`X-ResponseAction` tagæ¥ä¼ é€’callbackçš„Actionåç§°

**åŸå§‹SAGAå·¥ä½œæµç¨‹**ï¼ˆä¿®æ”¹å‰ï¼‰:
1. bobå‘é€GetInventoryItemè¯·æ±‚ï¼ŒTagsåŒ…å«ï¼š`X-SagaId`, `X-ResponseAction=GetInventoryItem_Callback`
2. aliceæ”¶åˆ°è¯·æ±‚ï¼Œä»Tagsæå–`X-ResponseAction`
3. aliceå“åº”æ—¶ï¼Œå°†`X-ResponseAction`çš„å€¼ä½œä¸ºresponseçš„`Action` tagå‘é€å›å»
4. bobæ”¶åˆ°å“åº”ï¼Œæ ¹æ®`Action` tagåŒ¹é…callback handler

**ä¸ºä»€ä¹ˆå¤±è´¥**:
- AOè¿‡æ»¤äº†è‡ªå®šä¹‰tag `X-ResponseAction`
- aliceæ”¶ä¸åˆ°`X-ResponseAction`ï¼Œæ— æ³•çŸ¥é“åº”è¯¥è®¾ç½®ä»€ä¹ˆ`Action`ç»™å“åº”æ¶ˆæ¯
- bobæ”¶åˆ°çš„å“åº”æ¶ˆæ¯æ²¡æœ‰æ­£ç¡®çš„`Action` tag
- callback handleræ— æ³•è¢«è§¦å‘

**è§£å†³æ–¹æ¡ˆ**:
æˆ‘ä»¬çš„DataåµŒå…¥æ–¹æ¡ˆæ˜¯å¯¹çš„ï¼ä½†éœ€è¦ç¡®ä¿ï¼š
1. âœ… bobåœ¨request Dataä¸­åµŒå…¥`X-ResponseAction`ï¼ˆå·²å®ç°ï¼‰
2. âœ… aliceä»Dataä¸­æå–`X-ResponseAction`ï¼ˆå·²å®ç°ï¼‰
3. âœ… aliceåœ¨responseæ—¶å°†`X-ResponseAction`ä½œä¸º`Action` tagï¼ˆå·²å®ç°ï¼‰
4. âœ… bobçš„callback handlerä½¿ç”¨TagåŒ¹é…è€Œä¸æ˜¯DataåŒ¹é…ï¼ˆå·²ä¿®å¤ï¼‰

### å‘ç° #8: Bugä¿®å¤ï¼ğŸ‰
**æ—¶é—´**: 2025-01-10
**Bug**: æ‰€æœ‰SAGA callback handlersé”™è¯¯åœ°ä½¿ç”¨äº†`messaging.hasMatchingDataAction`
**ä¿®å¤**: æ”¹ä¸ºä½¿ç”¨`Handlers.utils.hasMatchingTag("Action", ...)`
**åŸå› **: 
- `Action` tagä¸ä¼šè¢«è¿‡æ»¤
- `messaging.respond`å·²ç»æ­£ç¡®åœ°å°†`X-ResponseAction`ä»Dataä¸­æå–å¹¶è®¾ç½®ä¸º`Action` tag
- callback handleråº”è¯¥åŒ¹é…`Action` tagè€Œä¸æ˜¯ä»Dataä¸­æå–

**ä¿®å¤çš„æ–‡ä»¶**:
- `src/a_ao_demo.lua`: å°†5ä¸ªcallback handlersæ”¹ä¸ºä½¿ç”¨TagåŒ¹é…
- `src/messaging.lua`: åˆ é™¤äº†ä¸å†éœ€è¦çš„`messaging.hasMatchingDataAction`å‡½æ•°

## ğŸ”¬ ä¸‹ä¸€æ­¥è°ƒè¯•è®¡åˆ’

### Plan A: æ£€æŸ¥bobæ˜¯å¦å‘é€äº†GetInventoryItemè¯·æ±‚ âœ… è¿›è¡Œä¸­
- [x] æ·»åŠ DEBUG_LOG
- [ ] åœ¨SAGAèµ·å§‹handlerä¸­æ·»åŠ æ—¥å¿—ï¼Œç¡®è®¤æ˜¯å¦å‘é€äº†è¯·æ±‚

### Plan B: æ£€æŸ¥aliceæ˜¯å¦æ”¶åˆ°GetInventoryItemè¯·æ±‚
- [ ] åœ¨aliceçš„`get_inventory_item` handlerä¸­æ·»åŠ æ—¥å¿—
- [ ] æ£€æŸ¥aliceæ˜¯å¦æ”¶åˆ°æ¶ˆæ¯

### Plan C: æ£€æŸ¥aliceçš„å“åº”æ¶ˆæ¯
- [ ] æ£€æŸ¥aliceçš„å“åº”æ˜¯å¦åŒ…å«æ­£ç¡®çš„Action
- [ ] æ£€æŸ¥å“åº”çš„Dataæ˜¯å¦åŒ…å«Sagaä¿¡æ¯

## ğŸ“ ä»£ç ä¿®æ”¹è®°å½•

### ä¿®æ”¹ #1: messaging.hasMatchingDataAction (å¯èƒ½ä¸éœ€è¦)
**æ–‡ä»¶**: src/a_ao_demo.lua, src/messaging.lua
**åŸå› **: è¯¯è®¤ä¸ºAction tagè¢«è¿‡æ»¤
**çŠ¶æ€**: âš ï¸ å¯èƒ½éœ€è¦å›é€€

### ä¿®æ”¹ #2: DataåµŒå…¥Sagaä¿¡æ¯
**æ–‡ä»¶**: src/messaging.lua, src/inventory_service.lua
**åŸå› **: æ›¿ä»£Tagä¼ é€’
**çŠ¶æ€**: âœ… ä¿ç•™ï¼ˆä½œä¸ºå¢å¼ºåŠŸèƒ½ï¼‰

## ğŸ¯ æµ‹è¯•ç›®æ ‡
- [ ] `run-saga-tests.sh` å®Œå…¨é€šè¿‡
- [ ] aliceçš„åº“å­˜æ•°é‡æ›´æ–°ä¸º119
- [ ] bobçš„SAGAå®ä¾‹çŠ¶æ€ä¸ºcompleted

## ğŸ”¥ æœ€æ–°æµ‹è¯•ç»“æœ
**æ—¶é—´**: 2025-01-10
**çŠ¶æ€**: âŒ å¤±è´¥
**SAGAçŠ¶æ€**: å¡åœ¨æ­¥éª¤2ï¼ˆcurrent_step=2, completed=falseï¼‰
**åº“å­˜çŠ¶æ€**: æœªæ›´æ–°ï¼ˆä»ä¸º100ï¼‰

**é—®é¢˜åˆ†æ**:
- âŒ **æ­¥éª¤1çš„callbackä»æœªè¢«è§¦å‘ï¼** ï¼ˆBOB_CALLBACK_LOGä¸ºç©ºï¼‰
- âŒ bobçš„Inboxæ²¡æœ‰aliceçš„å“åº”æ¶ˆæ¯
- â“ aliceæ˜¯å¦å‘é€äº†å“åº”ï¼Ÿæˆ–è€…å“åº”çš„Action tagä¸æ­£ç¡®ï¼Ÿ

### å‘ç° #9: æ ¸å¿ƒé—®é¢˜ - æ­¥éª¤1çš„callbackæœªè¢«è§¦å‘ ğŸ”¥ğŸ”¥ğŸ”¥
**æ—¶é—´**: 2025-01-10  
**å…³é”®å‘ç°**:
- SAGAæ¨è¿›åˆ°æ­¥éª¤2ï¼Œä½†è¿™å¯èƒ½æ˜¯saga.create_saga_instanceæ—¶é»˜è®¤è®¾ç½®çš„
- æ­¥éª¤1çš„GetInventoryItem_Callbackä»æœªæ‰§è¡Œï¼ˆcallbackæ—¥å¿—ä¸ºç©ºï¼‰
- bobçš„Inboxæ²¡æœ‰æ¥è‡ªaliceçš„å“åº”æ¶ˆæ¯
- **å¯èƒ½åŸå› **:
  1. aliceçš„handleræ²¡æœ‰è¢«è§¦å‘ï¼ˆæ²¡æ”¶åˆ°è¯·æ±‚ï¼‰
  2. aliceçš„handleræ‰§è¡Œå‡ºé”™ï¼ˆæ²¡å‘é€å“åº”ï¼‰
  3. aliceå‘é€äº†å“åº”ï¼Œä½†Action tagè®¾ç½®ä¸æ­£ç¡®ï¼Œå¯¼è‡´æ²¡æœ‰handleråŒ¹é…ï¼ˆæ¶ˆæ¯åº”è¯¥åœ¨bobçš„Inboxï¼‰

## ğŸ’¡ é‡è¦æ´å¯Ÿ

### æ´å¯Ÿ #1: ä¸è¦è¿‡æ—©ä¸‹ç»“è®º
ä¹‹å‰è®¤ä¸ºActionè¢«è¿‡æ»¤æ˜¯é”™è¯¯çš„ã€‚éœ€è¦é€šè¿‡å®é™…æµ‹è¯•éªŒè¯æ¯ä¸€ä¸ªå‡è®¾ã€‚

### æ´å¯Ÿ #2: SAGAé€»è¾‘æ˜¯å·¥ä½œçš„
æ­¥éª¤1æˆåŠŸå®Œæˆè¯æ˜äº†SAGAæ ¸å¿ƒé€»è¾‘ã€æ¶ˆæ¯ä¼ é€’æœºåˆ¶ã€ActionåŒ¹é…éƒ½æ˜¯å¯ä»¥å·¥ä½œçš„ã€‚

### æ´å¯Ÿ #3: é—®é¢˜å¯èƒ½å¾ˆç®€å•
å¯èƒ½ä¸éœ€è¦`messaging.hasMatchingDataAction`è¿™æ ·çš„å¤æ‚ä¿®æ”¹ã€‚é—®é¢˜å¯èƒ½åªæ˜¯æŸä¸ªå°bugã€‚

---

**æœ€åæ›´æ–°**: 2025-01-10
**å½“å‰çŠ¶æ€**: ğŸ” è°ƒè¯•ä¸­

